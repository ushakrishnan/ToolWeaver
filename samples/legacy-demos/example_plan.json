{
  "request_id": "req-0001",
  "steps": [
    {
      "id": "step-1",
      "tool": "receipt_ocr",
      "input": {
        "image_uri": "https://images.sampletemplates.com/wp-content/uploads/2018/04/Detailed-Grocery-Payment-Receipt-Samples.jpg"
      },
      "depends_on": [],
      "mode": "parallel",
      "idempotency_key": "ocr-req-0001"
    },
    {
      "id": "step-2",
      "tool": "line_item_parser",
      "input": {
        "ocr_text": "step:step-1"
      },
      "depends_on": [
        "step-1"
      ],
      "mode": "sequential",
      "timeout_s": 120,
      "idempotency_key": "parse-req-0001"
    },
    {
      "id": "step-bridge",
      "tool": "code_exec",
      "input": {
        "code": "items = input['step_2']; output = {'item_count': len(items)}",
        "input_data": {
          "step_2": "step:step-2"
        }
      },
      "depends_on": [
        "step-2"
      ],
      "mode": "sequential",
      "idempotency_key": "bridge-req-0001"
    },
    {
      "id": "step-3",
      "tool": "expense_categorizer",
      "input": {
        "items": "step:step-2"
      },
      "depends_on": [
        "step-2"
      ],
      "mode": "parallel",
      "timeout_s": 120,
      "idempotency_key": "cat-req-0001"
    }
  ],
  "final_synthesis": {
    "prompt_template": "Create a user-facing summary from the following step outputs:\\n\\n{{steps}}",
    "meta": {
      "expose_inputs_to_reasoner": false
    }
  }
}